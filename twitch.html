<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Twitch Stream - Icha's Place</title>
  <!-- Preconnect and load Comic Neue Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="css/custom.css" rel="stylesheet">
  <style>
    html, body {
      font-family: 'Comic Neue', 'Comic Sans MS', 'Comic Sans', cursive, sans-serif !important;
      min-height: 100vh;
      margin: 0;
      padding: 0;
  background: url('https://dto9r5vaiz7bu.cloudfront.net/5bymdo5n76bbz/source.jpg') center center/cover no-repeat !important;
      background-color: #181818;
      color: #f3f3f3;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    .container {
      text-align: center;
      color: #f3f3f3;
      font-size: 1.15rem;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    h1, h2, h3, h4, h5, h6 {
      color: #fff !important;
      text-shadow: 0 2px 6px rgba(0,0,0,0.7);
      font-weight: 700;
    }
    .navbar.bg-dark {
      background-color: rgba(34, 34, 34, 0.3) !important;
      backdrop-filter: blur(4px);
      background: transparent !important;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <ul class="navbar-nav d-flex justify-content-center w-100">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="commodity-table.html">Multi Contract Cargo Tracker</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
          <li class="nav-item"><a class="nav-link active" href="twitch.html">Twitch</a></li>
          
          <li class="nav-item"><a class="nav-link" href="https://github.com/icha-senpai/" target="_blank">GitHub</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container" style="margin-top: 100px;">
    <h2 class="text-center mb-4" style="color: #fff;">Live on Twitch</h2>
    <div class="d-flex justify-content-center align-items-start my-4 flex-wrap flex-md-nowrap" style="gap: 1.5rem;">
      <!-- Opt-in placeholder for Twitch stream: real iframe injected only after user consents -->
  <div class="twitch-placeholder" data-src="https://player.twitch.tv/?channel=ichatv&parent=localhost&parent=127.0.0.1&parent=icha-senpai.github.io" data-title="Twitch stream player" data-width="960" data-height="540" style="max-width:100%; border-radius:8px;">
        <div class="placeholder-inner" style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;min-width:320px;min-height:200px;background:linear-gradient(180deg,#111,#222);border-radius:8px;padding:1rem;color:#eee;">
          <strong style="font-size:1.1rem;margin-bottom:.5rem;">Twitch stream</strong>
          <p style="margin:0 0 .75rem;color:#ccc;max-width:36rem;text-align:center;">The Twitch player is blocked until you choose to load it. Loading the player may cause Twitch to set third‑party cookies.</p>
          <div style="display:flex;gap:.5rem;align-items:center;">
            <button class="btn btn-primary btn-sm load-embed">Load stream</button>
            <label style="color:#bbb;font-size:.9rem;display:flex;align-items:center;gap:.35rem;margin-left:.5rem"><input type="checkbox" class="remember-choice"> Remember</label>
          </div>
        </div>
      </div>

      <!-- Opt-in placeholder for Twitch chat -->
  <div class="twitch-placeholder" data-type="chat" data-src="https://www.twitch.tv/embed/ichatv/chat?parent=localhost&parent=127.0.0.1&parent=icha-senpai.github.io" data-title="Twitch chat" data-width="350" data-height="540" style="max-width:100%; min-width:220px; border-radius:8px; background:#18181b;">
        <div class="placeholder-inner" style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;min-width:220px;min-height:200px;border-radius:8px;padding:1rem;color:#eee;">
          <strong style="font-size:1.1rem;margin-bottom:.5rem;">Twitch chat</strong>
          <p style="margin:0 0 .75rem;color:#ccc;max-width:24rem;text-align:center;">The chat is blocked until you choose to load it. Loading chat may cause Twitch to set third‑party cookies.</p>
          <div style="display:flex;gap:.5rem;align-items:center;">
            <button class="btn btn-secondary btn-sm load-embed">Load chat</button>
            <label style="color:#bbb;font-size:.9rem;display:flex;align-items:center;gap:.35rem;margin-left:.5rem"><input type="checkbox" class="remember-choice"> Remember</label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (for navbar toggler) -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" crossorigin="anonymous" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" crossorigin="anonymous" defer></script>
  <script>
    // Opt-in loader for third-party embeds to avoid setting third-party cookies until user consents.
    (function() {
      var STORAGE_KEY = 'twitch-embeds-consent-v1';
      function createIframe(src, title, w, h) {
        var ifr = document.createElement('iframe');
        ifr.src = src;
        ifr.title = title || '';
        ifr.width = w || '100%';
        ifr.height = h || '400';
        ifr.frameBorder = 0;
        ifr.scrolling = 'no';
        ifr.loading = 'lazy';
        ifr.referrerPolicy = 'no-referrer';
        ifr.allow = 'fullscreen';
        ifr.style.maxWidth = '100%';
        ifr.style.borderRadius = '8px';
        return ifr;
      }

      function injectPlaceholder(placeholder, remember) {
        var src = placeholder.getAttribute('data-src');
        var title = placeholder.getAttribute('data-title');
        var w = placeholder.getAttribute('data-width');
        var h = placeholder.getAttribute('data-height');
        var iframe = createIframe(src, title, w, h);
        // replace placeholder content
        placeholder.innerHTML = '';
        placeholder.appendChild(iframe);
        if (remember) {
          try { localStorage.setItem(STORAGE_KEY, 'true'); } catch (e) {}
        }
      }

      function init() {
        var consent = false;
        try { consent = !!localStorage.getItem(STORAGE_KEY); } catch (e) { consent = false; }
        var placeholders = document.querySelectorAll('.twitch-placeholder');
        placeholders.forEach(function(ph) {
          var btn = ph.querySelector('.load-embed');
          var chk = ph.querySelector('.remember-choice');
          if (consent) {
            injectPlaceholder(ph, false);
            return;
          }
          if (btn) btn.addEventListener('click', function() {
            var remember = chk && chk.checked;
            injectPlaceholder(ph, remember);
          });
        });
      }

      if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init); else init();
    })();
  </script>
</body>
</html>
